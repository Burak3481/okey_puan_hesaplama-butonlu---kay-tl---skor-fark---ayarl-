<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
<title>Okey Puan HesaplayÄ±cÄ±</title>
<style>
/* Sadece "Okey bitme seÃ§enekleri" ile "Eli Ekle" butonu arasÄ±ndaki boÅŸluk */
#okeyGrup + button { margin-top: 40px; }

body {
  font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif;
  background:#f6f6f6; margin:0; padding:0; color:#333;
}
.container {
  background:white; padding:20px; border-radius:12px; max-width:750px; margin:20px auto;
  box-shadow:0 4px 10px rgba(0,0,0,0.1);
}
h1 { color:#007aff; text-align:center; margin-bottom:15px; }
label { font-weight:600; display:block; margin-top:10px; }
input,button {
  width:100%; padding:15px; margin-top:10px; border-radius:10px; border:2px solid #ccc; font-size:15px; box-sizing:border-box;
}
button {
  background:#007aff; color:white; font-weight:bold; border:none; cursor:pointer; transition:0.2s;
}
button:hover { background:#005bbb; }
button:disabled { background:#ccc; cursor:not-allowed; }

#puanTablosu { width:100%; border-collapse:collapse; margin-top:30px; }
#puanTablosu th,#puanTablosu td { border:1px solid #ddd; padding:8px; text-align:center; }
#puanTablosu th { background:#007aff; color:white; }
tfoot td { font-weight:bold; background:#eee; }
.plus { color:#1aae55; font-weight:bold; }
.minus { color:#ff3b30; font-weight:bold; }

#kazanan {
  background:#e5f8e0; border:1px solid #b3e5a3; padding:15px; border-radius:12px; margin-top:15px;
  display:none; text-align:center; font-size:1.2em; font-weight:bold; color:#1aae55;
  opacity:0; transform:scale(0.8); transition:all 0.5s ease;
}
#kazanan.show { display:block; opacity:1; transform:scale(1); }

#resetBtn { background:#ff3b30; margin-top:20px; }
.deleteBtn {
  background:#ff3b30; color:white; border:none; padding:6px 8px; border-radius:6px; cursor:pointer; font-size:0.8em;
}
.deleteBtn:hover { background:#cc0000; }

.siyah { background-color:#d9d9d9; }
.kirmizi { background-color:#ffd6d6; }
.mavi { background-color:#d6e0ff; }
.sari { background-color:#fff6d6; }

#kimseBitmediAlani { display:none; margin-top:10px; }

.btn-group { display:flex; flex-wrap:wrap; gap:30px; margin-top:20px; }
.btn-option, .btn-color, .btn-okey {
  flex:1; text-align:center; border-radius:10px; padding:10px; font-weight:600; cursor:pointer; border:2px solid #ccc; transition:all 0.15s ease; user-select:none; color:#333;
}
/* Okey grubunda 3 buton olduÄŸu iÃ§in flex-basis ayarlamasÄ± */
#okeyGrup .btn-okey { flex: 5 0 calc(32% - 40px); }

.btn-option:hover, .btn-color:hover, .btn-okey:hover { background:#f0f0f0; }

.btn-teamA { border-color:#007aff; }
.btn-teamB { border-color:#ff3b30; }
.btn-none  { border-color:#888; }

.btn-option.active { color:white; transform:scale(1.02); }
.btn-teamA.active { background:#007aff; border-color:#005bbb; }
.btn-teamB.active { background:#ff3b30; border-color:#cc0000; }
.btn-none.active  { background:#555; border-color:#333; }

.btn-color.siyah { background:#333; color:white; }
.btn-color.kirmizi { background:#ff3b30; color:white; }
.btn-color.mavi { background:#007aff; color:white; }
.btn-color.sari { background:#ffcc00; color:#333; }
.btn-color.active { outline:4px solid #333; transform:scale(1.08); }

.btn-okey.hayir { background:#aaa; color:white; }
.btn-okey.okey { background:#1aae55; color:white; }
.btn-okey.ciftokey { background:#ffcc00; color:#333; } /* Yeni buton rengi */
.btn-okey.active { transform:scale(1.05); outline:6px solid #333; }

/* Yeni KatsayÄ± AyarlarÄ± Stilleri */
#katsayiAyarlari {
    margin-top: 15px;
    padding: 15px;
    background: #f0f0f0;
    border-radius: 10px;
    display: none; /* VarsayÄ±lan olarak kapalÄ± */
    animation: fadeIn 0.3s ease-out;
}
@keyframes fadeIn {
    from { opacity: 0; transform: translateY(-5px); }
    to { opacity: 1; transform: translateY(0); }
}
#katsayiAyarlari .katsayi-input {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-top: 10px;
}
#katsayiAyarlari .katsayi-input input {
    width: 60%;
    margin-top: 0;
    padding: 10px;
}
#katsayiAyarlari label {
    margin-top: 0;
}
#katsayiToggle {
    margin-bottom: 5px;
    background: #444;
}
#katsayiToggle:hover {
    background: #333;
}

/* Yeni eklenecek kÄ±sÄ±m: */
/* Beraberlik Ä°Ã§in Gereken TaÅŸ Tablosu BaÅŸlÄ±k ve Ä°Ã§erik HizalamasÄ± */
#farkAlani table th, #farkAlani table td {
    text-align: center !important; /* TÃ¼m iÃ§eriÄŸi ortalar */
    vertical-align: middle;
}
</style>
</head>
<body>
<div class="container">
  <h1>ğŸ§® Okey Puan HesaplayÄ±cÄ±</h1>

Â  <button id="katsayiToggle" onclick="toggleKatsayiAyarlari()">âš™ï¸ TaÅŸ KatsayÄ± AyarlarÄ±</button>

  <div id="katsayiAyarlari">
    <h4>TaÅŸ KatsayÄ±larÄ±nÄ± Ayarla</h4>
    <div class="katsayi-input">
      <label>âš« Siyah KatsayÄ±sÄ±:</label>
      <input type="number" id="katsayi_siyah" value="5" min="1" onchange="katsayiGuncelle()">
    </div>
    <div class="katsayi-input">
      <label>ğŸ”´ KÄ±rmÄ±zÄ± KatsayÄ±sÄ±:</label>
      <input type="number" id="katsayi_kirmizi" value="4" min="1" onchange="katsayiGuncelle()">
    </div>
    <div class="katsayi-input">
      <label>ğŸ”µ Mavi KatsayÄ±sÄ±:</label>
      <input type="number" id="katsayi_mavi" value="3" min="1" onchange="katsayiGuncelle()">
    </div>
    <div class="katsayi-input">
      <label>ğŸŸ¡ SarÄ± KatsayÄ±sÄ±:</label>
      <input type="number" id="katsayi_sari" value="2" min="1" onchange="katsayiGuncelle()">
    </div>
  </div>
Â  <button id="resetBtn" onclick="if(confirm('Yeni parti baÅŸlatÄ±lsÄ±n mÄ±?')) sifirla(); kaydetDurum();">Yeni Parti</button>

  <label>TakÄ±m Ä°simleri:</label>
  <input type="text" id="takimAIsim" value="TakÄ±m A">
  <input type="text" id="takimBIsim" value="TakÄ±m B">
  <button onclick="takimGuncelle(); kaydetDurum();">TakÄ±mlarÄ± GÃ¼ncelle</button>

  <label>Biten TakÄ±m:</label>
  <div class="btn-group" id="bitenGrup">
    <div class="btn-option btn-teamA active" data-value="A">TakÄ±m A</div>
    <div class="btn-option btn-teamB" data-value="B">TakÄ±m B</div>
    <div class="btn-option btn-none" data-value="yok">Kimse Bitmedi</div>
  </div>

  <label>Okey Rengi:</label>
  <div class="btn-group" id="renkGrup">
    <div class="btn-color siyah active" data-value="siyah">âš« Siyah</div>
    <div class="btn-color kirmizi" data-value="kirmizi">ğŸ”´ KÄ±rmÄ±zÄ±</div>
    <div class="btn-color mavi" data-value="mavi">ğŸ”µ Mavi</div>
    <div class="btn-color sari" data-value="sari">ğŸŸ¡ SarÄ±</div>
  </div>

  <div id="tekliAlan">
    <label>KarÅŸÄ± TakÄ±mÄ±n Per Olmayan TaÅŸ ToplamÄ±:</label>
    <input type="number" id="perOlmayanToplam" placeholder="Ã¶rn. 45"
      inputmode="numeric" pattern="[0-9]*">
  </div>

  <div id="kimseBitmediAlani">
    <label id="lblA">TakÄ±m A Per Olmayan TaÅŸ ToplamÄ±:</label>
    <input type="number" id="tasA" placeholder="Ã¶rn. 45" inputmode="numeric" pattern="[0-9]*">
    <label id="lblB">TakÄ±m B Per Olmayan TaÅŸ ToplamÄ±:</label>
    <input type="number" id="tasB" placeholder="Ã¶rn. 60" inputmode="numeric" pattern="[0-9]*">
  </div>

  <label>Biten taraf okey ile mi bitti?</label>
  <div class="btn-group" id="okeyGrup">
    <div class="btn-okey hayir active" data-value="hayir">âŒ HayÄ±r</div>
    <div class="btn-okey okey" data-value="okey">âœ… Evet (Okey ile)</div>
    <div class="btn-okey ciftokey" data-value="ciftokey">âœ¨ Ã‡ift + Okey</div>
  </div>

  <button onclick="elEkle(); kaydetDurum();">Eli Ekle</button>

  <table id="puanTablosu">
    <thead>
      <tr>
        <th>El</th><th>Biten</th><th>Renk</th><th>Durum</th>
        <th id="baslikA">A Puan</th><th id="baslikB">B Puan</th><th>ğŸ—‘ï¸</th>
      </tr>
    </thead>
    <tbody></tbody>
    <tfoot>
      <tr><td colspan="4">Toplam</td><td id="toplamA">0</td><td id="toplamB">0</td><td></td></tr>
    </tfoot>
  </table>

  <div id="kazanan"></div>

  <div id="farkAlani" style="margin-top:25px; padding:15px; background:#eef7ff; border-radius:10px;">
    <h3>Puan FarkÄ± ve Kazanma Ä°Ã§in Gereken TaÅŸ</h3>
    <p><b>Puan FarkÄ±:</b> <span id="farkGosterge">0</span></p>

    <h4>Beraberlik Ä°Ã§in Gereken Per Olmayan TaÅŸ SayÄ±sÄ±</h4>

    <table style="width:100%; border-collapse:collapse; margin-top:10px;">
      <thead>
        <tr style="background:#007aff; color:white;">
          <th>Renk</th>
          <th>Okeysiz Bitme</th>
          <th>Okey ile Bitme</th>
          <th>Ã‡ift + Okey ile Bitme</th> </tr>
      </thead>
      <tbody>
        <tr>
          <td>Siyah</td>
          <td id="gereken_siyah_okeysiz"></td>
          <td id="gereken_siyah_okey"></td>
          <td id="gereken_siyah_ciftokey"></td> </tr>
        <tr>
          <td>KÄ±rmÄ±zÄ±</td>
          <td id="gereken_kirmizi_okeysiz"></td>
          <td id="gereken_kirmizi_okey"></td>
          <td id="gereken_kirmizi_ciftokey"></td> </tr>
        <tr>
          <td>Mavi</td>
          <td id="gereken_mavi_okeysiz"></td>
          <td id="gereken_mavi_okey"></td>
          <td id="gereken_mavi_ciftokey"></td> </tr>
        <tr>
          <td>SarÄ±</td>
          <td id="gereken_sari_okeysiz"></td>
          <td id="gereken_sari_okey"></td>
          <td id="gereken_sari_ciftokey"></td> </tr>
      </tbody>
    </table>
  </div>

  <button id="ssBtn" style="display:none; background:#444; margin-top:20px;"
           onclick="tabloSS()">ğŸ“¸ Skor Tablosu Ekran GÃ¶rÃ¼ntÃ¼sÃ¼</button>

</div>

<script>
let elSayisi=0, toplamA=0, toplamB=0;
const maxEl=11;
// â­ renkKatsayi, artÄ±k dinamik olarak ayarlanabilen bir obje
let renkKatsayi={siyah:5,kirmizi:4,mavi:3,sari:2};
let bitenTakim="A", okeyRenk="siyah", okeyBitis="hayir";

// â­ 2. DeÄŸiÅŸiklik: KatsayÄ±larÄ± gÃ¼ncelleme ve yÃ¼kleme fonksiyonlarÄ±
function katsayiGuncelle() {
    renkKatsayi.siyah = parseInt(document.getElementById("katsayi_siyah").value) || 5;
    renkKatsayi.kirmizi = parseInt(document.getElementById("katsayi_kirmizi").value) || 4;
    renkKatsayi.mavi = parseInt(document.getElementById("katsayi_mavi").value) || 3;
    renkKatsayi.sari = parseInt(document.getElementById("katsayi_sari").value) || 2;
    kaydetDurum(); // KatsayÄ±larÄ± kaydet
    farkVeGerekenTasHesapla(); // KatsayÄ± deÄŸiÅŸince gereken taÅŸlarÄ± yeniden hesapla
}

function yukleKatsayilar() {
    // KatsayÄ±larÄ± localStorage'dan veya varsayÄ±lan deÄŸerlerden yÃ¼kle
    document.getElementById("katsayi_siyah").value = renkKatsayi.siyah;
    document.getElementById("katsayi_kirmizi").value = renkKatsayi.kirmizi;
    document.getElementById("katsayi_mavi").value = renkKatsayi.mavi;
    document.getElementById("katsayi_sari").value = renkKatsayi.sari;
}

function toggleKatsayiAyarlari() {
    const ayarlar = document.getElementById("katsayiAyarlari");
    ayarlar.style.display = ayarlar.style.display === "block" ? "none" : "block";
}
// â­ 2. DeÄŸiÅŸiklik BitiÅŸi

function grupSecici(id, callback){
  document.querySelectorAll(`#${id} .btn-option, #${id} .btn-color, #${id} .btn-okey`).forEach(btn=>{
    btn.addEventListener("click",()=>{
      btn.parentElement.querySelectorAll(".active").forEach(a=>a.classList.remove("active"));
      btn.classList.add("active");
      callback(btn.dataset.value);
      kaydetDurum(); // SeÃ§im deÄŸiÅŸince kaydet
    });
  });
}

grupSecici("bitenGrup",(v)=>{
  bitenTakim=v;
  document.getElementById("tekliAlan").style.display=v==="yok"?"none":"block";
  document.getElementById("kimseBitmediAlani").style.display=v==="yok"?"block":"none";
});
grupSecici("renkGrup",(v)=>okeyRenk=v);
grupSecici("okeyGrup",(v)=>okeyBitis=v);

function takimGuncelle(){
  const a=document.getElementById("takimAIsim").value||"TakÄ±m A";
  const b=document.getElementById("takimBIsim").value||"TakÄ±m B";
  document.getElementById("lblA").innerText=a+" Per Olmayan TaÅŸ ToplamÄ±:";
  document.getElementById("lblB").innerText=b+" Per Olmayan TaÅŸ ToplamÄ±:";
  document.getElementById("baslikA").innerText=a+" Puan";
  document.getElementById("baslikB").innerText=b+" Puan";
  document.querySelector("#bitenGrup .btn-teamA").innerText=a;
  document.querySelector("#bitenGrup .btn-teamB").innerText=b;
}

function hesapla(biten,renk,tas,okey){
  const k=renkKatsayi[renk];
  let bitenDus, digerEkle;
  let durumText="Normal"; // VarsayÄ±lan durum

  if(biten==="yok"){ return {a:tas.a*k,b:tas.b*k,durum:"Kimse Bitmedi"}; }

  const perToplam=tas;
  const yanik=perToplam>=100;

  // Standart durumlar
  if(okey==="hayir"){
    bitenDus=10*k;
    digerEkle=perToplam*k;
    durumText="Normal";
  } else if(okey==="okey"){
    // 1. DeÄŸiÅŸiklik: Okey ile bitme (Normal Okey)
    bitenDus=100*k;
    digerEkle=perToplam*k * 2; // Okey ile bitme (Normal) iÃ§in kural: karÅŸÄ± puanÄ± 2 katÄ±
    durumText="OKEY";
  } else if(okey==="ciftokey"){
    // 1. DeÄŸiÅŸiklik: Ã‡ift + Okey ile bitme (Okey ile bitme'nin 2 katÄ±)
    const normalOkeyDus = 100 * k;
    const normalOkeyEkle = perToplam * k * 2;
    
    bitenDus = normalOkeyDus * 2; // 100k'nÄ±n 2 katÄ± = 200k (Kendi puanÄ±nÄ±n 2 katÄ± silinir)
    digerEkle = normalOkeyEkle * 2; // (perToplam*k*2)'nin 2 katÄ± (KarÅŸÄ± puan 4 katÄ± eklenir)
    durumText="Ã‡ift + Okey";
  }


  // YanÄ±k durumu kontrolÃ¼ ve puanlarÄ±
  if(yanik){
    if(okey==="hayir"){
        bitenDus=10*k;
        digerEkle=100*k;
        durumText="YANIK";
    } else if(okey==="okey"){
        bitenDus=100*k;
        digerEkle=100*k; // Okey bitmiÅŸ ve YanÄ±k var: Okeyin 2 katÄ± kuralÄ± geÃ§erli olmalÄ±
        durumText="YanÄ±k + OKEY";
    } else if(okey==="ciftokey"){
        // 1. DeÄŸiÅŸiklik: YanÄ±k + Ã‡ift Okey
        const normalOkeyEkle = 100*k; // YanÄ±k durumunda normal okeyde eklenecek puan
        bitenDus = (100*k) * 2; // Ã‡ift Okeyin dÃ¼ÅŸÃ¼ÅŸÃ¼ (200k)
        digerEkle = normalOkeyEkle * 2; // Ã‡ift Okeyin eklenmesi (YanÄ±k Okey'in 2 katÄ±)
        durumText="YanÄ±k + Ã‡ift + Okey";
    }
  }

  // PuanlarÄ±n takÄ±mlara daÄŸÄ±tÄ±lmasÄ±
  if(biten==="A") return {a:-bitenDus,b:digerEkle,durum:durumText};
  else return {a:digerEkle,b:-bitenDus,durum:durumText};
}

function elEkle(){
  if(elSayisi>=maxEl){ alert("11 el tamamlandÄ±!"); return; }
  let sonuc;
  if(bitenTakim==="yok"){
    const ta=parseInt(document.getElementById("tasA").value);
    const tb=parseInt(document.getElementById("tasB").value);
    if(isNaN(ta)||isNaN(tb)){ alert("Ä°ki takÄ±mÄ±n taÅŸ toplamlarÄ±nÄ± giriniz!"); return; }
    sonuc=hesapla("yok",okeyRenk,{a:ta,b:tb},okeyBitis);
  }else{
    const per=parseInt(document.getElementById("perOlmayanToplam").value);
    if(isNaN(per)){ alert("Per olmayan taÅŸ toplamÄ±nÄ± giriniz!"); return; }
    sonuc=hesapla(bitenTakim,okeyRenk,per,okeyBitis);
  }
  elSayisi++;
  toplamA+=sonuc.a; toplamB+=sonuc.b;

  const tbody=document.querySelector("#puanTablosu tbody");
  const row=document.createElement("tr");
  row.className=okeyRenk;
  row.dataset.a=sonuc.a; row.dataset.b=sonuc.b;
  const aName=document.getElementById("takimAIsim").value||"TakÄ±m A";
  const bName=document.getElementById("takimBIsim").value||"TakÄ±m B";
  row.innerHTML=`
    <td>${elSayisi}</td>
    <td>${bitenTakim==="yok"?"Kimse Bitmedi":(bitenTakim==="A"?aName:bName)}</td>
    <td>${okeyRenk.toUpperCase()}</td>
    <td>${sonuc.durum}</td>
    <td class="${sonuc.a>=0?'plus':'minus'}">${sonuc.a>0?'+':''}${sonuc.a}</td>
    <td class="${sonuc.b>=0?'plus':'minus'}">${sonuc.b>0?'+':''}${sonuc.b}</td>
    <td><button class="deleteBtn" onclick="elSil(this)">Sil</button></td>`;
  tbody.appendChild(row);
  document.getElementById("toplamA").innerText=toplamA;
  document.getElementById("toplamB").innerText=toplamB;

  farkVeGerekenTasHesapla();

  if(elSayisi===maxEl) kazanan();
}

function elSil(btn){
  const tr=btn.closest("tr");
  toplamA-=Number(tr.dataset.a); toplamB-=Number(tr.dataset.b);
  tr.remove(); elSayisi--;
  document.getElementById("toplamA").innerText=toplamA;
  document.getElementById("toplamB").innerText=toplamB;
  document.getElementById("kazanan").classList.remove("show");

  farkVeGerekenTasHesapla();

  kaydetDurum();
}

function sifirla(){
  elSayisi=0; toplamA=0; toplamB=0;
  document.querySelector("#puanTablosu tbody").innerHTML="";
  document.getElementById("toplamA").innerText="0";
  document.getElementById("toplamB").innerText="0";
  document.getElementById("kazanan").classList.remove("show");
  document.getElementById("kazanan").innerText="";
  document.getElementById("ssBtn").style.display="none";

  // KatsayÄ±larÄ± varsayÄ±lana Ã§ek (Ä°stenmedi ancak tutarlÄ±lÄ±k iÃ§in)
  renkKatsayi={siyah:5,kirmizi:4,mavi:3,sari:2};
  yukleKatsayilar(); 
  
  farkVeGerekenTasHesapla();

  kaydetDurum();
}

function kazanan(){
  const a=document.getElementById("takimAIsim").value||"TakÄ±m A";
  const b=document.getElementById("takimBIsim").value||"TakÄ±m B";
  const div=document.getElementById("kazanan");
  if(toplamA<toplamB) div.innerText=`ğŸ† Kazanan: ${a} (${toplamA} - ${toplamB})`;
  else if(toplamB<toplamA) div.innerText=`ğŸ† Kazanan: ${b} (${toplamB} - ${toplamA})`;
  else div.innerText=`ğŸ¤ Berabere! (${toplamA} - ${toplamB})`;
  div.classList.add("show");

  document.getElementById("ssBtn").style.display="block";
}

// --- LocalStorage ile durum saklama ---
function kaydetDurum(){
  const data={
    elSayisi, toplamA, toplamB, bitenTakim, okeyRenk, okeyBitis,
    takimA: document.getElementById("takimAIsim").value,
    takimB: document.getElementById("takimBIsim").value,
    renkKatsayi: renkKatsayi, // â­ KatsayÄ±larÄ± da kaydet
    rows: Array.from(document.querySelectorAll("#puanTablosu tbody tr")).map(tr=>({
      innerHTML: tr.innerHTML, className: tr.className, dataset: {a: tr.dataset.a, b: tr.dataset.b}
    }))
  };
  localStorage.setItem("okeyDurum", JSON.stringify(data));
}

function yukleDurum(){
  const data=JSON.parse(localStorage.getItem("okeyDurum"));
  if(!data) { yukleKatsayilar(); return; } // Ä°lk aÃ§Ä±lÄ±ÅŸta katsayÄ±larÄ± yÃ¼kle
  
  elSayisi=data.elSayisi; toplamA=data.toplamA; toplamB=data.toplamB;
  bitenTakim=data.bitenTakim; okeyRenk=data.okeyRenk; okeyBitis=data.okeyBitis;
  document.getElementById("takimAIsim").value=data.takimA;
  document.getElementById("takimBIsim").value=data.takimB;
  
  if (data.renkKatsayi) { // â­ KatsayÄ±larÄ± yÃ¼kle
    renkKatsayi = data.renkKatsayi;
  }
  yukleKatsayilar(); // Input alanlarÄ±nÄ± gÃ¼ncelle
  
  takimGuncelle();

  const tbody=document.querySelector("#puanTablosu tbody");
  tbody.innerHTML="";
  data.rows.forEach(r=>{
    const tr=document.createElement("tr");
    tr.innerHTML=r.innerHTML; tr.className=r.className;
    tr.dataset.a=r.dataset.a; tr.dataset.b=r.dataset.b;
    tbody.appendChild(tr);
  });

  document.querySelectorAll("#bitenGrup .btn-option").forEach(b=>b.classList.toggle("active", b.dataset.value===bitenTakim));
  document.querySelectorAll("#renkGrup .btn-color").forEach(b=>b.classList.toggle("active", b.dataset.value===okeyRenk));
  document.querySelectorAll("#okeyGrup .btn-okey").forEach(b=>b.classList.toggle("active", b.dataset.value===okeyBitis));

  document.getElementById("toplamA").innerText=toplamA;
  document.getElementById("toplamB").innerText=toplamB;
  document.getElementById("tekliAlan").style.display=bitenTakim==="yok"?"none":"block";
  document.getElementById("kimseBitmediAlani").style.display=bitenTakim==="yok"?"block":"none";

  farkVeGerekenTasHesapla();

  if(elSayisi>=maxEl) {
    kazanan();
    document.getElementById("ssBtn").style.display="block";
  }
}

yukleDurum();

// â­ Gerekli TaÅŸ Hesaplama Fonksiyonu
function farkVeGerekenTasHesapla() {
    const tbody = document.querySelector("#puanTablosu tbody");
    const farkGosterge = document.getElementById("farkGosterge");
    const requiredFields = ["siyah", "kirmizi", "mavi", "sari"].flatMap(renk => [
        `gereken_${renk}_okeysiz`,
        `gereken_${renk}_okey`,
        `gereken_${renk}_ciftokey` // â­ Yeni alan
    ]);
    
    // EÄŸer skor tablosu boÅŸsa tÃ¼m deÄŸerleri sÄ±fÄ±r yap
    if (tbody.children.length === 0) {
        farkGosterge.innerText = "0";
        requiredFields.forEach(id => {
            document.getElementById(id).innerText = "0";
        });
        return;
    }

    const fark = Math.abs(toplamA - toplamB);
    farkGosterge.innerText = fark;

    const renkSirasi = [
        { id: "siyah", k: renkKatsayi.siyah },
        { id: "kirmizi", k: renkKatsayi.kirmizi },
        { id: "mavi", k: renkKatsayi.mavi },
        { id: "sari", k: renkKatsayi.sari },
    ];

    renkSirasi.forEach(r => {
        const k = r.k;
        const bitenTakimKaybi = 10 * k;
        
        // Okeysiz Bitme
        const okeysiz = (fark - bitenTakimKaybi) / k;
        
        // Okey ile Bitme (KarÅŸÄ± puan 2 katÄ±)
        // Denklem: Fark = (DigerTasinToplami * k * 2) - (-100 * k)
        // DigerTasinToplami = (Fark - 100k) / (2k)
        const okey = (fark - (100 * k)) / (2 * k);

        // Ã‡ift + Okey ile Bitme (KarÅŸÄ± puan 4 katÄ±)
        // Denklem: Fark = (DigerTasinToplami * k * 4) - (-200 * k)
        // DigerTasinToplami = (Fark - 200k) / (4k)
        const ciftokey = (fark - (200 * k)) / (4 * k); // â­ Yeni hesaplama

        document.getElementById(`gereken_${r.id}_okeysiz`).innerText = okeysiz.toFixed(2);
        document.getElementById(`gereken_${r.id}_okey`).innerText = okey.toFixed(2);
        document.getElementById(`gereken_${r.id}_ciftokey`).innerText = ciftokey.toFixed(2); // â­ Yeni alan
    });
}

// â­ SADECE SKOR TABLOSUNUN SSâ€™Ä°NÄ° ALMA FONKSÄ°YONU
function tabloSS(){
  const tablo = document.getElementById("puanTablosu");
  html2canvas(tablo).then(canvas=>{
    const link=document.createElement("a");
    link.download="skor_tablosu.png";
    link.href=canvas.toDataURL();
    link.click();
  });
}
</script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

</body>
</html>
